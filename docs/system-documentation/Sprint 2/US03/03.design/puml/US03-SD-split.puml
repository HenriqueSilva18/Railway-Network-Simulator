@startuml

skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false
autonumber

title System Sequence Diagram : US03 - Add a city

actor "Editor" as Editor
participant AddCityUI
participant AddCityController
participant AddHouseBlocksController as AddBHouseBlocksController

activate Editor
Editor -> AddCityUI : asks to add city
        activate AddCityUI
activate AddCityController
AddCityUI --> AddCityController : getAvailableMaps()

ref over AddCityController
GetAvailableMaps
end
AddCityController --> AddCityUI : mapsList
deactivate AddCityController

        AddCityUI --> Editor: shows a list of Maps
        deactivate AddCityUI
        Editor -> AddCityUI: selects a map
        activate AddCityUI
        AddCityUI --> Editor : asks for city name
        deactivate AddCityUI


    Editor -> AddCityUI: inputs name

        activate AddCityUI
        AddCityUI --> AddCityController: validateName(name)
        activate AddCityController
        AddCityController --> AddCityUI: name
        deactivate AddCityController
        AddCityUI --> Editor: asks for coordinates
        deactivate AddCityUI
    Editor -> AddCityUI: inputs coordinates
        activate AddCityUI
        AddCityUI --> AddCityController: validateCoordinates(x, y)
        activate AddCityController
        ref over AddCityController
        ValidateCoordinates()
        end
        AddCityController --> AddCityUI: coordinates
        deactivate AddCityController
        AddCityUI --> Editor: asks number of house blocks
        deactivate AddCityUI
    Editor -> AddCityUI: inputs number
        activate AddCityUI
        AddCityUI --> AddCityController: validateNumBlocks(numBlocks)
        activate AddCityController
        AddCityController --> AddCityUI: numBlocks
        deactivate AddCityController
        AddCityUI --> Editor: asks if the editor wants to assign the blocks manually or automatically
        deactivate AddCityUI
    Editor -> AddCityUI: selects yes/no
alt User selects "yes" (manual)
    AddCityUI --> AddBHouseBlocksController : assignBlocks(numBlocks)
    activate AddBHouseBlocksController
    activate AddCityUI
    ref over AddBHouseBlocksController


        AssignManualBlocks()
    end
    AddBHouseBlocksController --> AddCityUI : houseBlocks
    deactivate AddBHouseBlocksController

else User selects "no" (automatic)
    AddCityUI --> AddBHouseBlocksController : assignBlocks(numBlocks)
    activate AddBHouseBlocksController
    ref over AddBHouseBlocksController
        AssignAutoBlocks()
    end
    AddBHouseBlocksController --> AddCityUI : houseBlocks
    deactivate AddCityUI
    deactivate AddBHouseBlocksController

end alt
        AddCityUI --> Editor: asks for confirmation
        deactivate AddCityUI
        Editor -> AddCityUI: confirms

        activate AddCityUI

        deactivate AddCityController
        AddCityUI --> AddCityController: saveCity(name, coordinates, houseBlocks)
        activate AddCityController
        ref over AddCityController
        saveCity
        end
        AddCityController --> AddCityUI: city details + success
        deactivate AddCityController
        AddCityUI --> Editor: display city details + success

        deactivate AddCityUI


@enduml