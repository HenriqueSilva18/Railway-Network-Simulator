@startuml
skinparam packageStyle rectangle
skinparam shadowing false

participant ":StationBuildingController" as CTRL
participant "repositories\n:Repositories" as REPOS
participant "mapRepository\n:MapRepository" as MAP_REPO
participant "map\n:Map" as MAP
participant "appSession\n:ApplicationSession" as APP_SESSION

autonumber 7
-> CTRL : loadMap(nameID)

autonumber 7.1
activate CTRL
    group Load Selected Map
        CTRL -> REPOS: getInstance()
        activate REPOS
            REPOS --> CTRL: repositoriesInstance
        deactivate REPOS

        CTRL -> REPOS: mapRepository()
        activate REPOS
            REPOS --> CTRL: mapRepositoryInstance
        deactivate REPOS

        CTRL -> MAP_REPO: findMap(nameID)
        activate MAP_REPO
            MAP_REPO --> CTRL: selectedMap
        deactivate MAP_REPO

        CTRL -> APP_SESSION: getInstance()
        activate APP_SESSION
            APP_SESSION --> CTRL: sessionInstance
        deactivate APP_SESSION

        CTRL -> APP_SESSION: setCurrentMap(selectedMap)
        activate APP_SESSION
            APP_SESSION --> CTRL: success
        deactivate APP_SESSION

        CTRL -> MAP: getMapLayout()
        activate MAP
            MAP --> CTRL: mapLayout
        deactivate MAP
    end

    autonumber 8
    <-- CTRL : mapLayout
deactivate CTRL

@enduml 